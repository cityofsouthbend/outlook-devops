<<<<<<< HEAD
(()=>{"use strict";var e={9796:(e,t,n)=>{e.exports=n.p+"assets/icon-16.png"},9921:(e,t,n)=>{e.exports=n.p+"assets/icon-32.png"},4486:(e,t,n)=>{e.exports=n.p+"assets/icon-80.png"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{function e(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(a,o){var i=t.apply(n,r);function c(t){e(i,a,o,c,s,"next",t)}function s(t){e(i,a,o,c,s,"throw",t)}c(void 0)}))}}function r(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(9796),n(9921),n(4486);var o="",i=[],c=[],s=[],u="",l=function(e){return"https://dev.azure.com/southbendin/_apis/wit/workitems?ids=".concat(e.val,"&api-version=6.0")},p="https://dev.azure.com/southbendin/_apis/wit/wiql?api-version=6.0",d=function(e){return"https://dev.azure.com/southbendin/_apis/wit/workitems/".concat(e.val,"?api-version=6.0")},m=function(e){return"https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/wit/attachments?fileName=".concat(e.val,"&api-version=5.1")},f="Basic "+btoa("Basic:p6l4ydakwngcbswzyilmfhidth5vx57veh3djy6vxiiefap5dfaq"),h={method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:f},body:"{\n  \"query\": \"Select [System.Id], [System.Title], [System.State] From WorkItems Where [System.WorkItemType] = 'Maintenance' AND [System.State] <> 'Archived'\"}"},v={method:"GET",headers:{"Content-Type":"application/json",Authorization:f}};function y(e){var t="";return e.workItems.forEach((function(e){t+=e.id+","})),t.slice(0,-1)}function g(e){for(var t=new Map,n='<select id="parentItem" name="parentItem">',o=0;o<e.length;o++)t.set(e[o].id,e[o].fields["System.Title"]);var i;new Map((i=t,function(e){if(Array.isArray(e))return a(e)}(i)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(i)||r(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort((function(e,t){return String(e[1]).localeCompare(t[1])}))).forEach((function(e,t){var r='<option value="'.concat(t,'">').concat(e," - Maintenance Item: ").concat(t,"</option>");n+=r})),n+="</select>",document.querySelector("#dropdown").innerHTML=n}function b(e){var t;return{method:"POST",headers:{"Content-Type":"application/octet-stream",Authorization:f},body:(t={val:e},"".concat(t.val))}}function w(e,t){var n;return{method:"PATCH",headers:{"Content-Type":"application/json-patch+json",Authorization:f},body:JSON.stringify((n={val:e},[{op:"add",path:"/relations/-",value:{rel:"AttachedFile",url:"".concat(n.val),attributes:{comment:"Created with Outlook Azure add-in"}}},{op:"replace",path:"/fields/System.Description",value:"".concat(t)}]))}}function x(){return(x=t(regeneratorRuntime.mark((function e(){var t,n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(p,h);case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,r=y(n),e.next=9,fetch(l({val:r}),v);case 9:return a=e.sent,e.next=12,a.json();case 12:g(e.sent.value);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t){return S.apply(this,arguments)}function S(){return S=t(regeneratorRuntime.mark((function e(n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("data:".concat(n.ContentType,";base64, ").concat(n.ContentBytes)).then((function(e){return e.blob()})).then(function(){var e=t(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(m({val:n.Name}),{method:"POST",headers:{"Content-Type":"application/octet-stream",Authorization:f},body:a}).then((function(e){return e.json()})).then(function(){var e=t(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),a=o.replace('src="cid:'.concat(n.ContentId,'"'),'src="'.concat(t.url,'"')),o=a,console.log(o),e.next=6,fetch(d({val:r.id}),w(t.url,o)).then((function(e){return e.json()}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function A(){var e,n,a=function(){var e=document.getElementById("parentItem").value,t=document.getElementById("bug-ticket").checked?"Bug":"Task",n=document.getElementById("item-subject");return[t,e,""==n.value?n.placeholder:n.value,document.getElementById("users").value]}(),i=(n=4,function(e){if(Array.isArray(e))return e}(e=a)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}}(e,n)||r(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=i[0],l=i[1],p=i[2],m=i[3];fetch("https://vssps.dev.azure.com/southbendin/_apis/graph/users?api-version=6.0-preview.1",{method:"GET",headers:{Authorization:f}}).then((function(e){return e.json()})).then((function(e){for(var t=0;t<e.value.length;t++)if(e.value[t].displayName==document.getElementById("ticketCreator").value)return e.value[t]})).then((function(e){var n;fetch((n={val:u},"https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/wit/workitems/$".concat(n.val,"?bypassrules=true&api-version=6.0")),function(e,t,n,r){var a,o;return fetch("https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/work/teamsettings/iterations?$timeframe=current&api-version=6.0").then((function(e){return console.log(e)})),{method:"POST",headers:{"Content-Type":"application/json-patch+json",Authorization:f},body:JSON.stringify((a={val:t},o={val:e},[{op:"add",path:"/fields/System.Title",from:null,value:"".concat(a.val)},{op:"add",path:"/fields/System.CreatedBy",value:{displayName:"".concat(n.displayName),url:"".concat(n.url),_links:{avatar:{href:"".concat(n._links.avatar.href)}},id:"".concat(n.originId),uniqueName:"".concat(n.uniqueName),imageUrl:"".concat(n.imageUrl),descriptor:"".concat(n.descriptor)}},{op:"add",path:"/fields/System.ChangedBy",value:{displayName:"".concat(n.displayName),url:"".concat(n.url),_links:{avatar:{href:"".concat(n._links.avatar.href)}},id:"".concat(n.originId),uniqueName:"".concat(n.uniqueName),imageUrl:"".concat(n.imageUrl),descriptor:"".concat(n.descriptor)}},{op:"add",path:"/fields/System.AssignedTo",value:"".concat(r)},{op:"add",path:"/relations/-",value:{rel:"System.LinkTypes.Hierarchy-Reverse",url:"https://dev.azure.com/southbendin/_apis/wit/workItems/".concat(o.val),attributes:{isLocked:!1,name:"Parent"}}}]))}}(l,p,e,m)).then((function(e){return e.json()})).then(function(){var e=t(regeneratorRuntime.mark((function e(t){var n,r,a,i,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/wit/attachments?fileName=OriginalEmail.html&api-version=6.0",b(o));case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.next=8,fetch(d({val:t.id}),w(r.url));case 8:for(e.sent,a=document.querySelectorAll('input[type="checkbox"]:checked'),i=0;i<a.length;i++)for(u=0;u<s.length;u++)a[i].value==s[u].Name&&c.push(s[u]);l=0;case 12:if(!(l<c.length)){e.next=18;break}return e.next=15,k(c[l],t);case 15:l++,e.next=12;break;case 18:document.getElementById("app-body").innerHTML="<div>DevOps ticket ".concat(t.id,' has been created. View the ticket in DevOps <a href="https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_workitems/edit/').concat(t.id,'" target="_blank">here</a></div>');case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}function j(){return(j=t(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Outlook){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var t=document.getElementById("run");t.addEventListener("click",(function(){!function(){j.apply(this,arguments)}(),t.setAttribute("disabled","")})),function(){x.apply(this,arguments)}();var n=Office.context.mailbox.item;console.log(n),o+="<p>Begin display of original email</p>\n                      <hr>\n                      <p>From: ".concat(n.from.displayName," <br>\n                      Email: ").concat(n.from.emailAddress," <br>");var r=Office.context.mailbox.userProfile.displayName;i=Office.context.mailbox.item.attachments;for(var a=document.getElementById("files"),c="",l=[".png",".jpg",".gif",".jpeg",".bmp",".eps",".jpeg"],p=function(e){var t=l.some((function(t){return i[e].name.includes(t)}));c+=t?'<input type="checkbox" name="attachedFile" checked value="'.concat(i[e].name,'" style="visibility:hidden;">').concat(i[e].name,"<br>"):'<input type="checkbox" name="attachedFile" checked value="'.concat(i[e].name,'">').concat(i[e].name,"<br>")},d=0;d<i.length;d++)p(d);c+="<hr><p>All inline image files are included by default</p>",a.innerHTML=c,document.getElementById("item-subject").placeholder=n.subject,document.getElementById("ticketCreator").value=r,Office.context.mailbox.getCallbackTokenAsync({isRest:!0},(function(e){var t=Office.context.mailbox.item.itemId;u=e.value;var n=t.replaceAll("/","-").replaceAll("+","_"),r=(Office.context.mailbox.restUrl||"https://outlook.office365.com/api")+"/v2.0/me/messages/"+n,a=r+"/attachments",i=new XMLHttpRequest;i.open("GET",r),i.setRequestHeader("Prefer",'outlook.body-content-type="html"'),i.setRequestHeader("Authorization","Bearer "+u),i.onload=function(e){var t=JSON.parse(i.responseText);o+=t.Body.Content;var n=new XMLHttpRequest;n.open("GET",a),n.setRequestHeader("Authorization","Bearer "+u),n.onload=function(e){var t=JSON.parse(n.responseText);s=t.value},n.send()},i.send()}))}}))})()})();
=======
(()=>{"use strict";var e={9796:(e,t,n)=>{e.exports=n.p+"assets/icon-16.png"},9921:(e,t,n)=>{e.exports=n.p+"assets/icon-32.png"},4486:(e,t,n)=>{e.exports=n.p+"assets/icon-80.png"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}}(e,n)||t(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function c(e){o(i,r,a,c,s,"next",e)}function s(e){o(i,r,a,c,s,"throw",e)}c(void 0)}))}}n(9796),n(9921),n(4486);var i="",c=function(e){return"https://dev.azure.com/southbendin/_apis/wit/workitems?ids=".concat(e.val,"&api-version=6.0")},s="https://dev.azure.com/southbendin/_apis/wit/wiql?api-version=6.0",u=function(e){return"https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/wit/workitems/$".concat(e.val,"?api-version=6.0")},p=function(e){return"https://dev.azure.com/southbendin/_apis/wit/workitems/".concat(e.val,"?api-version=6.0")},l="https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/wit/attachments?fileName=EmailAsFileAttachment.txt&api-version=6.0";function d(){return(d=a(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",body:JSON.stringify({displayName:"new_token",scope:"app_token",validTo:"2022-12-01T23:46:23.319Z",allOrgs:!1})},e.next=3,fetch("https://vssps.dev.azure.com/{organization}/_apis/tokens/pats?api-version=6.1-preview.1",t);case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r.patToken.token);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var f="Basic "+btoa("Basic:"+function(){return d.apply(this,arguments)}()),m={method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:f},body:'{\n  "query": "Select [System.Id], [System.Title], [System.State] From WorkItems Where [System.WorkItemType] = \'Maintenance\'"}'},h={method:"GET",headers:{"Content-Type":"application/json",Authorization:f}};function v(e){var t="";return e.workItems.forEach((function(e){t+=e.id+","})),t.slice(0,-1)}function y(e){for(var n=new Map,o='<select id="parentItem" name="parentItem">',a=0;a<e.length;a++)n.set(e[a].id,e[a].fields["System.Title"]);var i;new Map((i=n,function(e){if(Array.isArray(e))return r(e)}(i)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(i)||t(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort((function(e,t){return String(e[1]).localeCompare(t[1])}))).forEach((function(e,t){var n='<option value="'.concat(t,'">').concat(e," - Maintenance Item: ").concat(t,"</option>");o+=n})),o+="</select>",document.querySelector("#dropdown").innerHTML=o}function b(){var e=document.getElementById("parentItem").value;return[document.getElementById("bug-ticket").checked?"Bug":"Task",e,document.getElementById("item-subject").value]}function g(e,t){var n,r;return{method:"POST",headers:{"Content-Type":"application/json-patch+json",Authorization:f},body:JSON.stringify((n={val:t},r={val:e},[{op:"add",path:"/fields/System.Title",from:null,value:"".concat(n.val)},{op:"add",path:"/relations/-",value:{rel:"System.LinkTypes.Hierarchy-Reverse",url:"https://dev.azure.com/southbendin/_apis/wit/workItems/".concat(r.val),attributes:{isLocked:!1,name:"Parent"}}}]))}}function w(e){var t;return{method:"POST",headers:{"Content-Type":"application/octet-stream",Authorization:f},body:(t={val:e},"".concat(t.val))}}function x(e){var t;return{method:"PATCH",headers:{"Content-Type":"application/json-patch+json",Authorization:f},body:JSON.stringify((t={val:e},[{op:"add",path:"/relations/-",value:{rel:"AttachedFile",url:"".concat(t.val),attributes:{comment:"Created with Outlook Azure add-in"}}}]))}}function k(){return(k=a(regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(s,m);case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,r=v(n),e.next=9,fetch(c({val:r}),h);case 9:return o=e.sent,e.next=12,o.json();case 12:y(e.sent.value);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return T.apply(this,arguments)}function T(){return(T=a(regeneratorRuntime.mark((function t(){var n,r,o,a,c,s,d,f,m,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=b(),r=e(n,3),o=r[0],a=r[1],c=r[2],t.next=3,fetch(u({val:o}),g(a,c));case 3:return s=t.sent,t.next=6,s.json();case 6:return d=t.sent,t.next=9,fetch(l,w(i));case 9:return f=t.sent,t.next=12,f.json();case 12:return m=t.sent,t.next=15,fetch(p({val:d.id}),x(m.url));case 15:return h=t.sent,t.next=18,h.json();case 18:t.sent,document.getElementById("app-body").innerHTML="<div>DevOps ticket ".concat(d.id,' has been created. View the ticket in DevOps <a href="https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_workitems/edit/').concat(d.id,'">here</a></div>');case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function j(){return A.apply(this,arguments)}function A(){return(A=a(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Outlook){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=j,function(){k.apply(this,arguments)}();var t=Office.context.mailbox.item,n=Office.context.mailbox.item.attachments;console.log(n),document.getElementById("item-subject").placeholder=t.subject,Office.context.mailbox.getCallbackTokenAsync({isRest:!0},(function(e){var t=Office.context.mailbox.item.itemId,n=e.value,r=t.replaceAll("/","-").replaceAll("+","_"),o=(Office.context.mailbox.restUrl||"https://outlook.office365.com/api")+"/v2.0/me/messages/"+r,a=new XMLHttpRequest;a.open("GET",o),a.setRequestHeader("Prefer",'outlook.body-content-type="text"'),a.setRequestHeader("Authorization","Bearer "+n),a.onload=function(e){var t=JSON.parse(a.responseText);i=t.Body.Content},a.send()}))}}))})()})();
>>>>>>> d3c72047e391e7856725fbffc93fd833ce8c836d
//# sourceMappingURL=taskpane.js.map