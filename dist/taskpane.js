(()=>{"use strict";var e={9796:(e,t,n)=>{e.exports=n.p+"assets/icon-16.png"},9921:(e,t,n)=>{e.exports=n.p+"assets/icon-32.png"},4486:(e,t,n)=>{e.exports=n.p+"assets/icon-80.png"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function r(e){return function(){var n=this,r=arguments;return new Promise((function(o,a){var i=e.apply(n,r);function c(e){t(i,o,a,c,s,"next",e)}function s(e){t(i,o,a,c,s,"throw",e)}c(void 0)}))}}function o(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(9796),n(9921),n(4486);var i="",c=function(e){return"https://dev.azure.com/southbendin/_apis/wit/workitems?ids=".concat(e.val,"&api-version=6.0")},s="https://dev.azure.com/southbendin/_apis/wit/wiql?api-version=6.0",u=function(e){return"https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/wit/workitems/$".concat(e.val,"?api-version=6.0")},l=function(e){return"https://dev.azure.com/southbendin/_apis/wit/workitems/".concat(e.val,"?api-version=6.0")},p="https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/wit/attachments?fileName=EmailAsFileAttachment.txt&api-version=6.0",d="Basic "+btoa("Basic:iinmtwdby2a5k3v6dekdc5y53raw7vsavivuss4fm47l4bu6fwzq"),f={method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:d},body:'{\n  "query": "Select [System.Id], [System.Title], [System.State] From WorkItems Where [System.WorkItemType] = \'Maintenance\'"}'},m={method:"GET",headers:{"Content-Type":"application/json",Authorization:d}};function h(e){var t="";return e.workItems.forEach((function(e){t+=e.id+","})),t.slice(0,-1)}function v(e){for(var t=new Map,n='<select id="parentItem" name="parentItem">',r=0;r<e.length;r++)t.set(e[r].id,e[r].fields["System.Title"]);var i;new Map((i=t,function(e){if(Array.isArray(e))return a(e)}(i)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(i)||o(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort((function(e,t){return String(e[1]).localeCompare(t[1])}))).forEach((function(e,t){var r='<option value="'.concat(t,'">').concat(e," - Maintenance Item: ").concat(t,"</option>");n+=r})),n+="</select>",document.querySelector("#dropdown").innerHTML=n}function y(){var e=document.getElementById("parentItem").value;return[document.getElementById("bug-ticket").checked?"Bug":"Task",e,document.getElementById("item-subject").value]}function b(e,t){var n,r;return{method:"POST",headers:{"Content-Type":"application/json-patch+json",Authorization:d},body:JSON.stringify((n={val:t},r={val:e},[{op:"add",path:"/fields/System.Title",from:null,value:"".concat(n.val)},{op:"add",path:"/relations/-",value:{rel:"System.LinkTypes.Hierarchy-Reverse",url:"https://dev.azure.com/southbendin/_apis/wit/workItems/".concat(r.val),attributes:{isLocked:!1,name:"Parent"}}}]))}}function w(e){var t;return{method:"POST",headers:{"Content-Type":"application/octet-stream",Authorization:d},body:(t={val:e},"".concat(t.val))}}function g(e){var t;return{method:"PATCH",headers:{"Content-Type":"application/json-patch+json",Authorization:d},body:JSON.stringify((t={val:e},[{op:"add",path:"/relations/-",value:{rel:"AttachedFile",url:"".concat(t.val),attributes:{comment:"Created with Outlook Azure add-in"}}}]))}}function x(){return(x=r(regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(s,f);case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,r=h(n),e.next=9,fetch(c({val:r}),m);case 9:return o=e.sent,e.next=12,o.json();case 12:v(e.sent.value);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return j.apply(this,arguments)}function j(){return(j=r(regeneratorRuntime.mark((function t(){var n,r,o,a,c,s,d,f,m,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=y(),r=e(n,3),o=r[0],a=r[1],c=r[2],t.next=3,fetch(u({val:o}),b(a,c));case 3:return s=t.sent,t.next=6,s.json();case 6:return d=t.sent,t.next=9,fetch(p,w(i));case 9:return f=t.sent,t.next=12,f.json();case 12:return m=t.sent,t.next=15,fetch(l({val:d.id}),g(m.url));case 15:return h=t.sent,t.next=18,h.json();case 18:t.sent,document.getElementById("app-body").innerHTML="<div>DevOps ticket ".concat(d.id,' has been created. View the ticket in DevOps <a href="https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_workitems/edit/').concat(d.id,'">here</a></div>');case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function k(){return A.apply(this,arguments)}function A(){return(A=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Outlook){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=k,function(){x.apply(this,arguments)}();var t=Office.context.mailbox.item;document.getElementById("item-subject").placeholder=t.subject,Office.context.mailbox.getCallbackTokenAsync({isRest:!0},(function(e){var t=Office.context.mailbox.item.itemId,n=e.value,r=t.replaceAll("/","-").replaceAll("+","_"),o=(Office.context.mailbox.restUrl||"https://outlook.office365.com/api")+"/v2.0/me/messages/"+r,a=new XMLHttpRequest;a.open("GET",o),a.setRequestHeader("Prefer",'outlook.body-content-type="text"'),a.setRequestHeader("Authorization","Bearer "+n),a.onload=function(e){var t=JSON.parse(a.responseText);i=t.Body.Content},a.send()}))}}))})()})();
//# sourceMappingURL=taskpane.js.map