(()=>{"use strict";var e={9796:(e,t,n)=>{e.exports=n.p+"assets/icon-16.png"},9921:(e,t,n)=>{e.exports=n.p+"assets/icon-32.png"},4486:(e,t,n)=>{e.exports=n.p+"assets/icon-80.png"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{function e(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(o,a){var i=t.apply(n,r);function c(t){e(i,o,a,c,s,"next",t)}function s(t){e(i,o,a,c,s,"throw",t)}c(void 0)}))}}function r(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(9796),n(9921),n(4486);var a="",i=[],c=[],s="",u=function(e){return"https://dev.azure.com/southbendin/_apis/wit/workitems?ids=".concat(e.val,"&api-version=6.0")},l="https://dev.azure.com/southbendin/_apis/wit/wiql?api-version=6.0",p=function(e){return"https://dev.azure.com/southbendin/_apis/wit/workitems/".concat(e.val,"?api-version=6.0")},d=function(e){return"https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/wit/attachments?fileName=".concat(e.val,"&api-version=5.1")},m="Basic "+btoa("Basic:p6l4ydakwngcbswzyilmfhidth5vx57veh3djy6vxiiefap5dfaq"),f={method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:m},body:"{\n  \"query\": \"Select [System.Id], [System.Title], [System.State] From WorkItems Where [System.WorkItemType] = 'Maintenance' AND [System.State] <> 'Archived'\"}"},h={method:"GET",headers:{"Content-Type":"application/json",Authorization:m}};function v(e){var t="";return e.workItems.forEach((function(e){t+=e.id+","})),t.slice(0,-1)}function y(e){for(var t=new Map,n='<select id="parentItem" name="parentItem">',a=0;a<e.length;a++)t.set(e[a].id,e[a].fields["System.Title"]);var i;new Map((i=t,function(e){if(Array.isArray(e))return o(e)}(i)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(i)||r(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort((function(e,t){return String(e[1]).localeCompare(t[1])}))).forEach((function(e,t){var r='<option value="'.concat(t,'">').concat(e," - Maintenance Item: ").concat(t,"</option>");n+=r})),n+="</select>",document.querySelector("#dropdown").innerHTML=n}function g(e){var t;return{method:"POST",headers:{"Content-Type":"application/octet-stream",Authorization:m},body:(t={val:e},"".concat(t.val))}}function b(e,t){var n;return{method:"PATCH",headers:{"Content-Type":"application/json-patch+json",Authorization:m},body:JSON.stringify((n={val:e},[{op:"add",path:"/relations/-",value:{rel:"AttachedFile",url:"".concat(n.val),attributes:{comment:"Created with Outlook Azure add-in"}}},{op:"replace",path:"/fields/System.Description",value:"".concat(t)}]))}}function w(e){var t;return{method:"PATCH",headers:{"Content-Type":"application/json-patch+json",Authorization:m},body:JSON.stringify((t={val:e},[{op:"add",path:"/fields/System.IterationPath",from:null,value:"".concat(t.val)}]))}}function x(){return(x=t(regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(l,f);case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,r=v(n),e.next=9,fetch(u({val:r}),h);case 9:return o=e.sent,e.next=12,o.json();case 12:y(e.sent.value);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t){return j.apply(this,arguments)}function j(){return j=t(regeneratorRuntime.mark((function e(n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("data:".concat(n.ContentType,";base64, ").concat(n.ContentBytes)).then((function(e){return e.blob()})).then(function(){var e=t(regeneratorRuntime.mark((function e(o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(d({val:n.Name}),{method:"POST",headers:{"Content-Type":"application/octet-stream",Authorization:m},body:o}).then((function(e){return e.json()})).then(function(){var e=t(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.replace('src="cid:'.concat(n.ContentId,'"'),'src="'.concat(t.url,'"')),a=o,e.next=4,fetch(p({val:r.id}),b(t.url,a)).then((function(e){return e.json()}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),j.apply(this,arguments)}function A(){var e,n,o=function(){var e=document.getElementById("parentItem").value,t=document.getElementById("bug-ticket").checked?"Bug":"Task",n=document.getElementById("item-subject");return[t,e,""==n.value?n.placeholder:n.value,document.getElementById("users").value]}(),s=(n=4,function(e){if(Array.isArray(e))return e}(e=o)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}}(e,n)||r(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=s[0],l=s[1],d=s[2],f=s[3];fetch("https://vssps.dev.azure.com/southbendin/_apis/graph/users?api-version=6.0-preview.1",{method:"GET",headers:{Authorization:m}}).then((function(e){return e.json()})).then((function(e){for(var t=0;t<e.value.length;t++)if(e.value[t].displayName==document.getElementById("ticketCreator").value)return e.value[t]})).then((function(e){var n;console.log(a),fetch((n={val:u},"https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/wit/workitems/$".concat(n.val,"?bypassrules=true&api-version=6.0")),function(e,t,n,r){var o,a;return fetch("https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/work/teamsettings/iterations?$timeframe=current&api-version=6.0").then((function(e){return console.log(e)})),{method:"POST",headers:{"Content-Type":"application/json-patch+json",Authorization:m},body:JSON.stringify((o={val:t},a={val:e},[{op:"add",path:"/fields/System.Title",from:null,value:"".concat(o.val)},{op:"add",path:"/fields/System.CreatedBy",value:{displayName:"".concat(n.displayName),url:"".concat(n.url),_links:{avatar:{href:"".concat(n._links.avatar.href)}},id:"".concat(n.originId),uniqueName:"".concat(n.uniqueName),imageUrl:"".concat(n.imageUrl),descriptor:"".concat(n.descriptor)}},{op:"add",path:"/fields/System.ChangedBy",value:{displayName:"".concat(n.displayName),url:"".concat(n.url),_links:{avatar:{href:"".concat(n._links.avatar.href)}},id:"".concat(n.originId),uniqueName:"".concat(n.uniqueName),imageUrl:"".concat(n.imageUrl),descriptor:"".concat(n.descriptor)}},{op:"add",path:"/fields/System.AssignedTo",value:"".concat(r)},{op:"add",path:"/relations/-",value:{rel:"System.LinkTypes.Hierarchy-Reverse",url:"https://dev.azure.com/southbendin/_apis/wit/workItems/".concat(a.val),attributes:{isLocked:!1,name:"Parent"}}}]))}}(l,d,e,f)).then((function(e){return e.json()})).then(function(){var e=t(regeneratorRuntime.mark((function e(t){var n,r,o,s,u,l,d,f,h,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/wit/attachments?fileName=OriginalEmail.html&api-version=6.0",g(a));case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.next=8,fetch(p({val:t.id}),b(r.url,a));case 8:return e.sent,e.next=11,fetch("https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/work/teamsettings/iterations?$timeframe=current&api-version=6.0",{method:"GET",headers:{"Content-Type":"application/json",Authorization:m}});case 11:return o=e.sent,e.next=14,o.json();case 14:return s=e.sent,console.log(s),e.next=18,fetch(p({val:t.id}),w(s.value[0].path));case 18:for(u=e.sent,l=u.json(),console.log(l),d=document.querySelectorAll('input[type="checkbox"]:checked'),f=0;f<d.length;f++)for(h=0;h<c.length;h++)d[f].value==c[h].Name&&i.push(c[h]);v=0;case 24:if(!(v<i.length)){e.next=30;break}return e.next=27,k(i[v],t);case 27:v++,e.next=24;break;case 30:document.getElementById("app-body").innerHTML="<div>DevOps ticket ".concat(t.id,' has been created. View the ticket in DevOps <a href="https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_workitems/edit/').concat(t.id,'" target="_blank">here</a></div>');case 31:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}function S(){return(S=t(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Outlook){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex";var t=document.getElementById("run");t.addEventListener("click",(function(){!function(){S.apply(this,arguments)}(),t.setAttribute("disabled","")})),function(){x.apply(this,arguments)}();var n=Office.context.mailbox.item;console.log(n),a+="<p>Begin display of original email</p>\n                      <hr>\n                      <p>From: ".concat(n.from.displayName," <br>\n                      Email: ").concat(n.from.emailAddress," <br>");var r=Office.context.mailbox.userProfile.displayName;d=Office.context.mailbox.item.attachments;for(var o=document.getElementById("files"),i="",u=[".png",".jpg",".gif",".jpeg",".bmp",".eps",".jpeg"],l=function(e){var t=u.some((function(t){return d[e].name.includes(t)}));i+=t?'<input type="checkbox" name="attachedFile" checked value="'.concat(d[e].name,'" style="visibility:hidden;"><br>'):'<input type="checkbox" name="attachedFile" checked value="'.concat(d[e].name,'">').concat(d[e].name,"<br>")},p=0;p<d.length;p++)l(p);i+='<hr><p class="small-tag">Inline image files are included by default</p>',o.innerHTML=i;var d=Office.context.mailbox.item.attachments;console.log(d),document.getElementById("item-subject").placeholder=n.subject,document.getElementById("ticketCreator").value=r,Office.context.mailbox.getCallbackTokenAsync({isRest:!0},(function(e){var t=Office.context.mailbox.item.itemId;s=e.value;var n=t.replaceAll("/","-").replaceAll("+","_"),r=(Office.context.mailbox.restUrl||"https://outlook.office365.com/api")+"/v2.0/me/messages/"+n,o=r+"/attachments",i=new XMLHttpRequest;i.open("GET",r),i.setRequestHeader("Prefer",'outlook.body-content-type="html"'),i.setRequestHeader("Authorization","Bearer "+s),i.onload=function(e){var t=JSON.parse(i.responseText);a+=t.Body.Content;var n=new XMLHttpRequest;n.open("GET",o),n.setRequestHeader("Authorization","Bearer "+s),n.onload=function(e){var t=JSON.parse(n.responseText);c=t.value},n.send()},i.send()}))}}))})()})();
//# sourceMappingURL=taskpane.js.map