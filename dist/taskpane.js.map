{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack:///webpack/bootstrap?","webpack:///webpack/runtime/define property getters?","webpack:///webpack/runtime/global?","webpack:///webpack/runtime/hasOwnProperty shorthand?","webpack:///webpack/runtime/publicPath?","webpack:///./src/taskpane/taskpane.js?"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","/* eslint-disable prettier/prettier */\r\n/* eslint-disable no-undef */\r\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\n// images references in the manifest\r\nimport \"../../assets/icon-16.png\";\r\nimport \"../../assets/icon-32.png\";\r\nimport \"../../assets/icon-80.png\";\r\n\r\n// global variables\r\nlet textAttachment = \"\";\r\n\r\nconst idURL = ($) => `https://dev.azure.com/southbendin/_apis/wit/workitems?ids=${$.val}&api-version=6.0`;\r\nconst wiqlURL = 'https://dev.azure.com/southbendin/_apis/wit/wiql?api-version=6.0';\r\nconst ticketURL = ($) =>\r\n  `https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/wit/workitems/$${$.val}?api-version=6.0`;\r\nconst updateAttachmentURL = ($) => `https://dev.azure.com/southbendin/_apis/wit/workitems/${$.val}?api-version=6.0`;\r\nconst createAttachmentURL = `https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/wit/attachments?fileName=EmailAsFileAttachment.txt&api-version=6.0`;\r\n\r\n\r\nasync function createToken() {\r\n  const tokenHeaders = {method: 'POST', body: JSON.stringify(\r\n    {\r\n      \"displayName\": \"new_token\",\r\n      \"scope\": \"app_token\",\r\n      \"validTo\": \"2022-12-01T23:46:23.319Z\",\r\n      \"allOrgs\": false\r\n    }\r\n  )};\r\n\r\n  let token = await fetch('https://vssps.dev.azure.com/{organization}/_apis/tokens/pats?api-version=6.1-preview.1', tokenHeaders);\r\n  let tokenResponse = await token.json();\r\n  return tokenResponse.patToken.token;\r\n}\r\nconst paToken = \"Basic \" + btoa(\"Basic\" + \":\" + createToken());\r\n//\"iinmtwdby2a5k3v6dekdc5y53raw7vsavivuss4fm47l4bu6fwzq\"\r\nconst queryWIQL = `{\r\n  \"query\": \"Select [System.Id], [System.Title], [System.State] From WorkItems Where [System.WorkItemType] = 'Maintenance'\"}`;\r\n\r\nconst headersWIQL = {\r\n  method: \"POST\",\r\n  headers: { \"Content-Type\": \"application/json;charset=utf-8\", Authorization: paToken },\r\n  body: queryWIQL\r\n};\r\nconst headersMaintenance = {\r\n  method: \"GET\",\r\n  headers: { \"Content-Type\": \"application/json\", Authorization: paToken }};\r\n\r\nfunction concatIDs(data) {\r\n  let str = \"\";\r\n  data.workItems.forEach((element) => { str += element.id + \",\"  });\r\n  return str.slice(0, -1);\r\n}\r\n\r\nfunction createDropdown(data) {\r\n  const maintenanceItems = new Map();\r\n  let html = `<select id=\"parentItem\" name=\"parentItem\">`;\r\n  for (let d = 0; d < data.length; d++) {\r\n    maintenanceItems.set(data[d].id, data[d].fields[\"System.Title\"]);\r\n  }\r\n  const sortedItems = new Map([...maintenanceItems].sort((a, b) => String(a[1]).localeCompare(b[1])));\r\n  sortedItems.forEach(function (v, k) {\r\n    let htmlSegment = `<option value=\"${k}\">${v} - Maintenance Item: ${k}</option>`;\r\n    html += htmlSegment;\r\n  }); \r\n  html += `</select>`;\r\n  let container = document.querySelector(\"#dropdown\");\r\n  container.innerHTML = html;\r\n}\r\n\r\nfunction grabFormItems() {\r\n  let selectResult = document.getElementById(\"parentItem\").value;\r\n  //Get bug or task ticket\r\n  let ticketType = document.getElementById(\"bug-ticket\").checked ? \"Bug\" : \"Task\";\r\n  //get title for ticket\r\n  let ticketTitle = document.getElementById(\"item-subject\").value;\r\n\r\n  return [ticketType, selectResult, ticketTitle];\r\n}\r\n\r\nfunction createTicketHeader(parent, ticketTitle) {\r\n  const newBody = ($1, $2) => [\r\n    {\"op\": \"add\", \"path\": \"/fields/System.Title\", \"from\": null, \"value\": `${$1.val}` },\r\n    {\"op\": \"add\", \"path\": \"/relations/-\", \"value\": { \"rel\": \"System.LinkTypes.Hierarchy-Reverse\", \"url\": `https://dev.azure.com/southbendin/_apis/wit/workItems/${$2.val}`, \"attributes\": { \"isLocked\": false, \"name\": \"Parent\" }}}];\r\n\r\n  const headersNewTicket = {method: 'POST', headers: { 'Content-Type': 'application/json-patch+json','Authorization': paToken}, body: JSON.stringify(newBody({val: ticketTitle}, {val: parent}))};\r\n\r\n  return headersNewTicket;\r\n}\r\n\r\nfunction createAttachmentHeader(emailText) {\r\n  const textBody = ($) => `${$.val}`;\r\n\r\n  const makeAttachment = {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/octet-stream\", Authorization: paToken },\r\n    body: textBody({val: emailText})\r\n  };\r\n\r\n  return makeAttachment;\r\n}\r\n\r\nfunction addAttachmentHeader(attachURL) {\r\n  const newBody = ($) => [{\"op\": \"add\", \"path\": \"/relations/-\", \"value\": { \"rel\": \"AttachedFile\", \"url\": `${$.val}`, \"attributes\": {\"comment\": \"Created with Outlook Azure add-in\"}}}];\r\n\r\n  const headerAddAttachment = {\r\n    method: \"PATCH\",\r\n    headers: { \"Content-Type\": \"application/json-patch+json\", Authorization: paToken },\r\n    body: JSON.stringify(newBody({val: attachURL}))\r\n  };\r\n\r\n  return headerAddAttachment;\r\n}\r\n\r\nasync function getMaintenanceItems() {\r\n  let responseWIQL = await fetch(wiqlURL, headersWIQL);\r\n  let dataWIQL = await responseWIQL.json();\r\n  let ids = concatIDs(dataWIQL);\r\n  \r\n  let responseMaintenance = await fetch(idURL({val: ids}), headersMaintenance);\r\n  let dataMaintenance = await responseMaintenance.json();\r\n  createDropdown(dataMaintenance.value);\r\n}\r\n\r\nasync function createNewTicket() {\r\n  let [ticketType, parent, ticketTitle] = grabFormItems();\r\n  \r\n  let responseTicket = await fetch(ticketURL({val: ticketType}), createTicketHeader(parent, ticketTitle));\r\n  let dataTicket = await responseTicket.json();\r\n\r\n  let responseNewAttachment = await fetch(createAttachmentURL, createAttachmentHeader(textAttachment));\r\n  let dataAttachment = await responseNewAttachment.json();\r\n  \r\n  let responseAddAttachment = await fetch(updateAttachmentURL({val: dataTicket.id}), addAttachmentHeader(dataAttachment.url));\r\n  let dataAddAttachment = await responseAddAttachment.json();\r\n\r\n  document.getElementById(\"app-body\").innerHTML = `<div>DevOps ticket ${dataTicket.id} has been created. View the ticket in DevOps <a href=\"https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_workitems/edit/${dataTicket.id}\">here</a></div>`;\r\n}\r\n\r\n// function getIteration() {\r\n//   let request2 = new XMLHttpRequest();\r\n//   let newURL = `https://dev.azure.com/southbendin/Applications%20-%20Project%20Portfolio/_apis/work/teamsettings/iterations?$timeframe=current&api-version=6.0`;\r\n//   request2.open(\"GET\", newURL);\r\n//   request2.setRequestHeader(\"Content-Type\", \"application/json\");\r\n//   request2.setRequestHeader(\r\n//     \"Authorization\",\r\n//     \"Basic \" + btoa(\"Basic\" + \":\" + \"iinmtwdby2a5k3v6dekdc5y53raw7vsavivuss4fm47l4bu6fwzq\")\r\n//   );\r\n//   request2.send();\r\n//   request2.onload = () => {\r\n//     res2 = JSON.parse(request2.response);\r\n//     let currentPath = res2.value[0].path;\r\n//     createTicket(currentPath);\r\n//   };\r\n// }\r\n\r\n// Office generated code when add-in is sideloaded\r\nOffice.onReady((info) => {\r\n  if (info.host === Office.HostType.Outlook) {\r\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\r\n    document.getElementById(\"app-body\").style.display = \"flex\";\r\n    document.getElementById(\"run\").onclick = run;\r\n    \r\n    getMaintenanceItems();\r\n    var item = Office.context.mailbox.item;\r\n\r\n        \r\n    var attachments = Office.context.mailbox.item.attachments;\r\n    console.log(attachments);\r\n    \r\n    // Write message property value to the task pane\r\n    document.getElementById(\"item-subject\").placeholder = item.subject;\r\n    Office.context.mailbox.getCallbackTokenAsync({ isRest: true }, (result) => {\r\n      var ewsId = Office.context.mailbox.item.itemId;\r\n      var token = result.value;\r\n  \r\n      // var restId = Office.context.mailbox.convertToRestId(ewsId, Office.MailboxEnums.RestVersion.v2_0); this does not work on API version 1.1\r\n      var restId = ewsId.replaceAll(\"/\", \"-\").replaceAll(\"+\", \"_\"); // Convert ewsId to restId\r\n      var getMessageUrl = (Office.context.mailbox.restUrl || 'https://outlook.office365.com/api') + '/v2.0/me/messages/' + restId;\r\n      var xhr = new XMLHttpRequest();\r\n      xhr.open('GET', getMessageUrl);\r\n      xhr.setRequestHeader('Prefer', 'outlook.body-content-type=\"text\"') \r\n      xhr.setRequestHeader(\"Authorization\", \"Bearer \" + token);\r\n      xhr.onload = (e) => {\r\n        var json = JSON.parse(xhr.responseText);\r\n        textAttachment = json.Body.Content;\r\n      }\r\n      xhr.send();\r\n    });\r\n    // Office.context.mailbox.item.from.getAsync(function(asyncResult) {\r\n    //   if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\r\n    //     textAttachment += asyncResult.value + \"\\n\\n\";\r\n    //     console.log(\"Message from: \" + msgFrom.displayName + \" (\" + msgFrom.emailAddress + \")\");\r\n    //   } else {\r\n    //     console.error(asyncResult.error);\r\n    //   }\r\n    // });\r\n    // Office.context.mailbox.item.body.getAsync(\r\n    //   \"text\",\r\n    //   { asyncContext: \"This is passed to the callback\" },\r\n    //   function callback(result) {\r\n    //     textAttachment += result.value;\r\n    //     // document.getElementById(\"item-body\").innerHTML = \"<b>New Ticket Description:</b> <br/>\" + result.value;\r\n    //     // Do something with the result.\r\n    //   }\r\n    // );\r\n     //API call to get Maintenance Items\r\n  }\r\n});\r\n\r\nexport async function run() {\r\n  createNewTicket();\r\n} // end run()\r\n"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","src","scripts","getElementsByTagName","length","Error","replace","p","textAttachment","idURL","$","val","wiqlURL","ticketURL","updateAttachmentURL","createAttachmentURL","tokenHeaders","method","body","JSON","stringify","fetch","token","json","tokenResponse","patToken","paToken","btoa","createToken","headersWIQL","headers","Authorization","headersMaintenance","concatIDs","data","str","workItems","forEach","element","id","slice","createDropdown","maintenanceItems","Map","html","set","fields","sort","a","b","String","localeCompare","v","k","htmlSegment","querySelector","innerHTML","grabFormItems","selectResult","getElementById","value","checked","createTicketHeader","parent","ticketTitle","$1","$2","createAttachmentHeader","emailText","addAttachmentHeader","attachURL","responseWIQL","dataWIQL","ids","responseMaintenance","createNewTicket","ticketType","responseTicket","dataTicket","responseNewAttachment","dataAttachment","url","responseAddAttachment","run","Office","onReady","info","host","HostType","Outlook","style","display","onclick","getMaintenanceItems","item","context","mailbox","attachments","console","log","placeholder","subject","getCallbackTokenAsync","isRest","result","ewsId","itemId","restId","replaceAll","getMessageUrl","restUrl","xhr","XMLHttpRequest","open","setRequestHeader","onload","parse","responseText","Body","Content","send"],"sourceRoot":""}